package com.minderv.scanners.impl;

import com.minderv.core.model.ScanResult;
import java.util.List;
import java.util.Map;

public class VulnerabilityDB {
    private static final Map<String, List<String>> DB = Map.of(
            "80/tcp", List.of("CVE-2023-1234", "HTTP Header Injection"),
            "22/tcp", List.of("CVE-2023-5678", "SSH Weak Encryption")
    );

    public static List<ScanResult.Vulnerability> checkVulnerabilities(List<ScanResult.PortInfo> ports) {
        return ports.stream()
                .filter(p -> DB.containsKey(p.port() + "/" + p.service().toLowerCase()))
                .map(p -> {
                    List<String> details = DB.get(p.port() + "/" + p.service().toLowerCase());
                    return new ScanResult.Vulnerability(
                            p.service(),
                            details.get(0),
                            details.get(1),
                            "High"
                    );
                })
                .toList();
    }
}